<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open CASCADE Technology: Data Exchange Wrapper (DE_Wrapper)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Open CASCADE Technology"/>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="occ_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open CASCADE Technology
   &#160;<span id="projectnumber">7.8.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('occt_user_guides__de_wrapper.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Data Exchange Wrapper (DE_Wrapper) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#occt_de_wrapper_1">Introduction</a></li>
<li class="level1"><a href="#occt_de_wrapper_2">Supported CAD formats</a></li>
<li class="level1"><a href="#occt_de_wrapper_3">DE Session Configuration</a><ul><li class="level2"><a href="#occt_de_wrapper_3_1">Getting a DE session. Code sample</a></li>
<li class="level2"><a href="#occt_de_wrapper_3_2">Configuration resource</a><ul><li class="level3"><a href="#occt_de_wrapper_3_2_1">Configuration resource: graph of scopes</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_2_2">Loading configuration resources. Configuring DE Session</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_2_3">Loading configuration resources. Code sample</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_2_4">Loading configuration resources. DRAW sample</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_2_5">Saving configuration resources. Dump of configuration DE Session</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_2_6">Saving configuration resources. Code sample</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_2_7">Saving configuration resources. DRAW sample</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_de_wrapper_3_3">Registering providers</a><ul><li class="level3"><a href="#occt_de_wrapper_3_3_1">Registering providers. Code sample</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_3_2">Registering providers. DRAW Sample</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_3_3">Realtime initialization. Code sample</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_de_wrapper_3_4">Priority of Vendors</a><ul><li class="level3"><a href="#occt_de_wrapper_3_4_1">Priority of Vendors. Code sample</a></li>
<li class="level3"><a href="#occt_de_wrapper_3_4_2">Priority of Vendors. DRAW Sample</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#occt_de_wrapper_4">Transfer of CAD files</a><ul><li class="level2"><a href="#occt_de_wrapper_4_1">Transfer of CAD files. Code samples</a></li>
<li class="level2"><a href="#occt_de_wrapper_4_2">Transfer of CAD files. DRAW samples</a></li>
<li class="level2"><a href="#occt_de_wrapper_4_3">Transfer using DE Provider. Code sample</a></li>
<li class="level2"><a href="#occt_de_wrapper_4_4">Temporary configuration via transfer</a><ul><li class="level3"><a href="#occt_de_wrapper_4_4_1">Temporary configuration via transfer. Code sample</a></li>
<li class="level3"><a href="#occt_de_wrapper_4_4_2">Temporary configuration via transfer. DRAW sample</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="occt_de_wrapper_1"></a>
Introduction</h1>
<p>This guide explains how to use the <b>Data Exchange Wrapper</b> (DE Wrapper). It provides basic directions on setup, usage and file creation via DE_Wrapper.</p>
<p>The Data Exchange Wrapper (DE Wrapper) module allows reading and writing supported CAD formats to shape objects or special XDE documents, setting up the transfer process for all CAD files.</p>
<p>It is also possible to add support for new CAD formats by prototyping existing tools.</p>
<p>The DE Wrapper component requires <a class="el" href="occt_user_guides__xde.html">XDE</a> toolkit for operation.</p>
<p>This guide mainly explains how to convert CAD files to Open CASCADE Technology (OCCT) shapes and vice versa. This guide principally deals with the following OCCT classes:</p><ul>
<li>The Provider class, which loads CAD files and translates their contents to OCCT shapes or XDE documents, or translates OCCT shapes or XDE documents to CAD entities and then writes those entities to a CAD file.</li>
<li>The Configuration class, which contains all information for the transfer process, such as the units, tolerance, and all internal information for the OCC readers or writers.</li>
<li>The wrapper class, which contains all loaded configuration objects with own CAD format, reads or writes CAD files in the format derived from file extension or contents and saves or loads configuration settings for loaded configuration objects.</li>
</ul>
<h1><a class="anchor" id="occt_de_wrapper_2"></a>
Supported CAD formats</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">CAD format </th><th class="markdownTableHeadLeft">Extensions </th><th class="markdownTableHeadLeft">RW support </th><th class="markdownTableHeadLeft">Thread Safety </th><th class="markdownTableHeadLeft">Presentation </th><th class="markdownTableHeadLeft">Package  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">STEP </td><td class="markdownTableBodyLeft">.stp, .step .stepz </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">No </td><td class="markdownTableBodyLeft">BRep, Mesh </td><td class="markdownTableBodyLeft">STEPCAFControl  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">XCAF </td><td class="markdownTableBodyLeft">.xbf </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">Yes </td><td class="markdownTableBodyLeft">BRep, Mesh </td><td class="markdownTableBodyLeft">DEXCAFCascade  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">BREP </td><td class="markdownTableBodyLeft">.brep </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">Yes </td><td class="markdownTableBodyLeft">BRep, Mesh </td><td class="markdownTableBodyLeft">DEBRepCascade  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">IGES </td><td class="markdownTableBodyLeft">.igs, .iges </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">No </td><td class="markdownTableBodyLeft">BRep </td><td class="markdownTableBodyLeft">IGESCAFControl  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">OBJ </td><td class="markdownTableBodyLeft">.obj </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">Yes </td><td class="markdownTableBodyLeft">Mesh </td><td class="markdownTableBodyLeft">RWObj  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">STL </td><td class="markdownTableBodyLeft">.stl </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">Yes </td><td class="markdownTableBodyLeft">Mesh </td><td class="markdownTableBodyLeft">RWStl  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">PLY </td><td class="markdownTableBodyLeft">.ply </td><td class="markdownTableBodyLeft">W </td><td class="markdownTableBodyLeft">Yes </td><td class="markdownTableBodyLeft">Mesh </td><td class="markdownTableBodyLeft">RWPly  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GLTF </td><td class="markdownTableBodyLeft">.glTF .glb </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">Yes </td><td class="markdownTableBodyLeft">Mesh </td><td class="markdownTableBodyLeft">RWGltf  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">VRML </td><td class="markdownTableBodyLeft">.wrl .vrml </td><td class="markdownTableBodyLeft">RW </td><td class="markdownTableBodyLeft">Yes </td><td class="markdownTableBodyLeft">Mesh </td><td class="markdownTableBodyLeft">Vrml  </td></tr>
</table>
<p><b>Note</b> :</p><ul>
<li>The format names in the first column match the FormatName values used for configuration nodes.</li>
<li>The VendorName for all listed CAD formats is "OCC".</li>
</ul>
<h1><a class="anchor" id="occt_de_wrapper_3"></a>
DE Session Configuration</h1>
<p>Any providers can have their own read/write parameters. The transfer process is set up using DE configuration nodes, which hold all relevant parameters. There are two ways to change the parameter values: directly from code or by an external resource file/string. The session is a global or static DE_Wrapper object that stores registered DE configuration nodes and wraps DE commands to work with them. It has some configuration parameters of its own and also keeps track of loaded nodes and specilal global parameters.</p>
<h2><a class="anchor" id="occt_de_wrapper_3_1"></a>
Getting a DE session. Code sample</h2>
<p>Working with a DE session requires a DE_Wrapper object to be loaded or created first.</p>
<p>Getting the global DE_Wrapping object: </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
</div><!-- fragment --><p>Creating a local DE_Wrapper: </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = <span class="keyword">new</span> DE_Wrapper();</div>
</div><!-- fragment --><p>It is recommended to create a local one-time copy to work with the session, if no global changes are intended. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aOneTimeSession = aSession-&gt;Copy();</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_de_wrapper_3_2"></a>
Configuration resource</h2>
<p>Configuration resource is an external file or string of the following format: </p><div class="fragment"><div class="line">global.priority.STEP :   OCC DTK</div>
<div class="line">global.general.length.unit :     1</div>
<div class="line">provider.STEP.OCC.read.precision.val :   0.0001</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_3_2_1"></a>
Configuration resource: graph of scopes</h3>
<ul>
<li><b>global.</b> is a scope of global parameters<ul>
<li><b>priority.</b> is a scope of priority to use vendors with their providers.</li>
<li><b>general.</b> is a scope of global configuration parameter values</li>
<li><b>"..."</b> is an internal configuration with any internal scopes</li>
<li><b>". : "</b> is a separator of key-value</li>
<li>__...__ parameter value, can't contain new line symbols.</li>
</ul>
</li>
<li><b>provider.</b> is a scope of configuration providers<ul>
<li><b>STEP.</b> is a scope of CAD format to configure</li>
<li><b>OCC.</b> is a scope of a vendor or provider</li>
<li><b>"..."</b> is an internal configuration with any internal scopes</li>
<li><b>". : "</b> is a separator of key-value</li>
<li><b>"..."</b> parameter value, can't contain new line symbols.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="occt_de_wrapper_3_2_2"></a>
Loading configuration resources. Configuring DE Session</h3>
<p>The resource should be loaded after the registration of all providers that should be configured. The resource only impacts registered parameters. To configure a new registered provider it is necessary to load the resource again. Parameters not present in the resource will remain unchanged.</p>
<p>There are two ways to check what parameters are available:</p><ul>
<li>C++: Open ConfigureNode file and check the InternalParameter field. Each parameter will be described with a comment. To check the global parameters, use the DE_Wrapper class public methods.</li>
<li>Resource: Register all available Nodes to the session, then save the configuration and view all existing parameters.</li>
</ul>
<p>There are two options for loading a resource: recursive and global parameters only. Recursive is the default option to configure all global parameters (units, priority, enable status) and all registered providers. Non-recursive configures only global parameters and ignores all provider settings. This option is the best for updating provider priority.</p>
<h3><a class="anchor" id="occt_de_wrapper_3_2_3"></a>
Loading configuration resources. Code sample</h3>
<p>Configuring using a resource string: </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aString =</div>
<div class="line">  <span class="stringliteral">&quot;global.priority.STEP :   OCC DTK\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;global.general.length.unit : 1\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;provider.STEP.OCC.read.precision.val : 0.\n&quot;</span>;</div>
<div class="line">Standard_Boolean aIsRecursive = Standard_True;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Load(aString, aIsRecursive))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: configuration is incorrect&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Configuring using a resource file: </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aPathToFile = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">Standard_Boolean aIsRecursive = Standard_True;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Load(aPathToFile, aIsRecursive))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: configuration is incorrect&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_3_2_4"></a>
Loading configuration resources. DRAW sample</h3>
<p>Configuring using a resource string: </p><div class="fragment"><div class="line">set conf <span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">global.priority.STEP :   OCC</span></div>
<div class="line"><span class="stringliteral">global.general.length.unit :     1</span></div>
<div class="line"><span class="stringliteral">provider.STEP.OCC.read.iges.bspline.continuity :         1</span></div>
<div class="line"><span class="stringliteral">provider.STEP.OCC.read.precision.mode :  0</span></div>
<div class="line"><span class="stringliteral">provider.STEP.OCC.read.precision.val :   0.0001</span></div>
<div class="line"><span class="stringliteral">&quot;</span></div>
<div class="line">LoadConfiguration ${conf} -recursive on</div>
</div><!-- fragment --><p>Configuring using a resource file: </p><div class="fragment"><div class="line">set pathToFile <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">LoadConfiguration ${pathToFile} -recursive on</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_3_2_5"></a>
Saving configuration resources. Dump of configuration DE Session</h3>
<p>Saving the configuration of a DE Session involves dumping all parameters of registered providers. If a parameter did not change during the session, its value remains as default.</p>
<p>There are two ways to save a resource: recursive and global parameters only. Recursive is the way to dump all registered provider information. Non-recursive dumps only global parameters, for example, save priority of vendors or the length unit.</p>
<p>It is possible to filter what vendors or providers to save by providing the correct name of the vendor or provider.</p>
<h3><a class="anchor" id="occt_de_wrapper_3_2_6"></a>
Saving configuration resources. Code sample</h3>
<p>Dump to resource string. If the vendors list is empty, saves all vendors. If the providers list is empty, saves all providers of valid vendors. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TColStd_ListOfAsciiString aFormats;</div>
<div class="line">TColStd_ListOfAsciiString aVendors;</div>
<div class="line">aFormats.Appends(<span class="stringliteral">&quot;STEP&quot;</span>);</div>
<div class="line">aVendors.Appends(<span class="stringliteral">&quot;OCC&quot;</span>);</div>
<div class="line">Standard_Boolean aIsRecursive = Standard_True;</div>
<div class="line">TCollection_AsciiString aConf = aSession-&gt;aConf-&gt;Save(aIsRecursive, aFormats, aVendors);</div>
</div><!-- fragment --><p>Configure using a resource file. If the vendors list is empty, saves all vendors. If the providers list is empty, saves all providers of valid vendors. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aPathToFile = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">TColStd_ListOfAsciiString aFormats;</div>
<div class="line">TColStd_ListOfAsciiString aVendors;</div>
<div class="line">aFormats.Appends(<span class="stringliteral">&quot;STEP&quot;</span>);</div>
<div class="line">aVendors.Appends(<span class="stringliteral">&quot;OCC&quot;</span>);</div>
<div class="line">Standard_Boolean aIsRecursive = Standard_True;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Save(aPathToFile, aIsRecursive, aFormats,aVendors))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: configuration is not saved&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_3_2_7"></a>
Saving configuration resources. DRAW sample</h3>
<p>Dump configuration to string. If no list of vendors is passed or it is empty, all vendors are saved. If no providers list is passed or it is empty, all providers of valid vendors are saved. </p><div class="fragment"><div class="line">set vendors <span class="stringliteral">&quot;OCC&quot;</span></div>
<div class="line">set format <span class="stringliteral">&quot;STEP&quot;</span></div>
<div class="line">set dump_conf [DumpConfiguration -recursive on -format ${format} -vendor ${vendors}]</div>
</div><!-- fragment --><p>Dump configuration to file. If no vendors list are set as an argument or it is empty, saves all vendors. If no providers list as argument or it is empty, saves all providers of valid vendors: </p><div class="fragment"><div class="line">set vendors <span class="stringliteral">&quot;OCC&quot;</span></div>
<div class="line">set format <span class="stringliteral">&quot;STEP&quot;</span></div>
<div class="line">set pathToFile <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">DumpConfiguration -path ${pathToFile} -recursive on -format ${format} -vendor ${vendors}</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_de_wrapper_3_3"></a>
Registering providers</h2>
<p>To transfer a CAD file using DE Wrapper, it is necessary to register a CAD provider. The provider contains internal and global parameters that have default values in the creation stage. All registered providers are set to the map with information about its vendor and kept as smart handles. Therefore, it is possible to change the values via handle from external code.</p>
<h3><a class="anchor" id="occt_de_wrapper_3_3_1"></a>
Registering providers. Code sample</h3>
<p>It is nesessary to register only one ConfigurationNode for all needed formats. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">Handle(DE_ConfigurationNode) aNode = <span class="keyword">new</span> STEPCAFControl_ConfigurationNode();</div>
<div class="line">aSession-&gt;Bind(aNode);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_3_3_2"></a>
Registering providers. DRAW Sample</h3>
<p>Use DRAW with all providers registered by the following command: </p><div class="fragment"><div class="line">pload XDE</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_3_3_3"></a>
Realtime initialization. Code sample</h3>
<p>It is possible to change a paramater from code using a smart pointer.</p>
<div class="fragment"><div class="line"><span class="comment">// global variable</span></div>
<div class="line"><span class="keyword">static</span> Handle(STEPCAFControl_ConfigurationNode) THE_STEP_NODE;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> Handle(DE_ConfigurationNode) RegisterStepNode()</div>
<div class="line">{</div>
<div class="line">  Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">  <span class="keywordflow">if</span> (!THE_STEP_NODE.IsNull())</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">return</span> THE_STEP_NODE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  THE_STEP_NODE = <span class="keyword">new</span> STEPCAFControl_ConfigurationNode();</div>
<div class="line">  aSession-&gt;Bind(THE_STEP_NODE);</div>
<div class="line">  <span class="keywordflow">return</span> THE_STEP_NODE;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Change parameter value</span></div>
<div class="line">THE_STEP_NODE-&gt;InternalParameters.ReadRelationship = <span class="keyword">false</span>;</div>
<div class="line">THE_STEP_NODE-&gt;InternalParameters.ReadName = <span class="keyword">false</span>;</div>
<div class="line">THE_STEP_NODE-&gt;InternalParameters.ReadProps = <span class="keyword">false</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_de_wrapper_3_4"></a>
Priority of Vendors</h2>
<p>DE session is able to work with several vendors with the same supported CAD format. To choose the preffered vendor for each format, use a special priority list.</p>
<p>If the high priority vendor's provider is not supported, a transfer operation is needed (write/read), then the next vendor will be chosen.</p>
<h3><a class="anchor" id="occt_de_wrapper_3_4_1"></a>
Priority of Vendors. Code sample</h3>
<div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aFormat = <span class="stringliteral">&quot;STEP&quot;</span>;</div>
<div class="line">TColStd_ListOfAsciiString aVendors;</div>
<div class="line">aVendors.Appends(<span class="stringliteral">&quot;OCC&quot;</span>); <span class="comment">// high priority</span></div>
<div class="line">aVendors.Appends(<span class="stringliteral">&quot;DTK&quot;</span>);</div>
<div class="line"><span class="comment">// Flag to disable not choosen vendors, in this case configuration is possible</span></div>
<div class="line"><span class="comment">// otherwise, lower their priority and continue to check ability to transfer</span></div>
<div class="line">Standard_Boolean aToDisable = Standard_True;</div>
<div class="line">aSession-&gt;ChangePriority(aFormat, aVendors, aToDisable);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_3_4_2"></a>
Priority of Vendors. DRAW Sample</h3>
<p>It is recommended to disable recursion and update only global parameters. </p><div class="fragment"><div class="line">set conf <span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">global.priority.STEP :   OCC DTK</span></div>
<div class="line"><span class="stringliteral">&quot;</span></div>
<div class="line">LoadConfiguration ${conf} -recursive off</div>
</div><!-- fragment --><h1><a class="anchor" id="occt_de_wrapper_4"></a>
Transfer of CAD files</h1>
<p>To transfer from a CAD file to OCC or from OCC to a CAD file, it is necessary to use a configured DE_Wrapper object. It can be local, one-time or global. Global configuration of DE_Wrapper propagates to all nodes via transfer. There are two options for transferring: using OCC shape or XCAF document. It is possible to work only with real path to/from the file. Streaming is not supported (yet).</p>
<p>The format of input/output file is automatically determined by its extension or contents.</p>
<h2><a class="anchor" id="occt_de_wrapper_4_1"></a>
Transfer of CAD files. Code samples</h2>
<p>Reading STEP file to Shape. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aPathToFile = <span class="stringliteral">&quot;example.stp&quot;</span>;</div>
<div class="line">TopoDS_Shape aShRes;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Read(aPathToFile, aShRes))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: Can&#39;t read file&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Writing Shape to STEP file. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aPathToFile = <span class="stringliteral">&quot;example.stp&quot;</span>;</div>
<div class="line">TopoDS_Shape aShFrom = ...;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Write(aPathToFile, aShRes))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: Can&#39;t write file&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Reading STEP file into XCAF document. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aPathToFile = <span class="stringliteral">&quot;example.stp&quot;</span>;</div>
<div class="line">Handle(TDocStd_Document) aDoc = ...;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Read(aPathToFile, aDoc))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: Can&#39;t read file&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Writing XCAF document into STEP. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper();</div>
<div class="line">TCollection_AsciiString aPathToFile = <span class="stringliteral">&quot;example.stp&quot;</span>;</div>
<div class="line">Handle(TDocStd_Document) aDoc = ...;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Write(aPathToFile, aDoc))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: Can&#39;t write file&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_de_wrapper_4_2"></a>
Transfer of CAD files. DRAW samples</h2>
<p>Reading a STEP file into a Shape. </p><div class="fragment"><div class="line">set fileName <span class="stringliteral">&quot;sample.stp&quot;</span></div>
<div class="line">readfile shape ${fileName}</div>
</div><!-- fragment --><p>Writing a Shape into STEP. </p><div class="fragment"><div class="line">set fileName <span class="stringliteral">&quot;sample.stp&quot;</span></div>
<div class="line">writefile shape ${fileName}</div>
</div><!-- fragment --><p>Reading STEP into XCAF document. </p><div class="fragment"><div class="line">set fileName <span class="stringliteral">&quot;sample.stp&quot;</span></div>
<div class="line">ReadFile D ${fileName}</div>
</div><!-- fragment --><p>Writing XCAF document into STEP. </p><div class="fragment"><div class="line">set fileName <span class="stringliteral">&quot;sample.stp&quot;</span></div>
<div class="line">WriteFile D ${fileName}</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_de_wrapper_4_3"></a>
Transfer using DE Provider. Code sample</h2>
<p>It is possible to read and write CAD files directly from a special provider.</p>
<div class="fragment"><div class="line"><span class="comment">// Creating or getting node</span></div>
<div class="line">Handle(STEPCAFControl_ConfigurationNode) aNode = <span class="keyword">new</span> STEPCAFControl_ConfigurationNode();</div>
<div class="line"><span class="comment">// Creationg an one-time provider</span></div>
<div class="line">Handle(DE_Provider) aProvider = aNode-&gt;BuildProvider();</div>
<div class="line"><span class="comment">// Setting configuration with all parameters</span></div>
<div class="line">aProvider-&gt;SetNode(aNode);</div>
<div class="line"><span class="keywordflow">if</span> (!aProvider-&gt;Read(...))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: Can&#39;t read STEP file&quot;</span>;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (!aProvider-&gt;Write(...))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: Can&#39;t write STEP file&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_de_wrapper_4_4"></a>
Temporary configuration via transfer</h2>
<p>It is possible to change the configuration of only one transfer operation. To avoid changing parameters in a session, one-time clone of the session can be created and used for transfer. This way is recommended for use in multithreaded mode.</p>
<h3><a class="anchor" id="occt_de_wrapper_4_4_1"></a>
Temporary configuration via transfer. Code sample</h3>
<p>Code sample to configure via transfer. </p><div class="fragment"><div class="line">Handle(DE_Wrapper) aSession = DE_Wrapper::GlobalWrapper()-&gt;Copy();</div>
<div class="line">TCollection_AsciiString aString =</div>
<div class="line">  <span class="stringliteral">&quot;global.priority.STEP :   OCC DTK\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;global.general.length.unit : 1\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;provider.STEP.OCC.read.precision.val : 0.\n&quot;</span>;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Load(aString, aIsRecursive))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: configuration is incorrect&quot;</span>;</div>
<div class="line">}</div>
<div class="line">TCollection_AsciiString aPathToFile = <span class="stringliteral">&quot;example.stp&quot;</span>;</div>
<div class="line">TopoDS_Shape aShRes;</div>
<div class="line"><span class="keywordflow">if</span> (!aSession-&gt;Read(aPathToFile, aShRes))</div>
<div class="line">{</div>
<div class="line">  Message::SendFail() &lt;&lt; <span class="stringliteral">&quot;Error: Can&#39;t read file&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_de_wrapper_4_4_2"></a>
Temporary configuration via transfer. DRAW sample</h3>
<p>Code sample to configure via transfer within DRAW command. </p><div class="fragment"><div class="line">set fileName <span class="stringliteral">&quot;sample.stp&quot;</span></div>
<div class="line">readfile S5 $filename -conf <span class="stringliteral">&quot;global.general.length.unit : 1000 &quot;</span></div>
</div><!-- fragment --><p>Code sample to configure via transfer as variable. </p><div class="fragment"><div class="line">set fileName <span class="stringliteral">&quot;sample.stp&quot;</span></div>
<div class="line">set conf <span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">global.priority.STEP :   OCC</span></div>
<div class="line"><span class="stringliteral">global.general.length.unit :     1</span></div>
<div class="line"><span class="stringliteral">provider.STEP.OCC.read.iges.bspline.continuity :         1</span></div>
<div class="line"><span class="stringliteral">provider.STEP.OCC.read.precision.mode :  0</span></div>
<div class="line"><span class="stringliteral">provider.STEP.OCC.read.precision.val :   0.0001</span></div>
<div class="line"><span class="stringliteral">&quot;</span></div>
<div class="line">readfile S5 $filename -conf ${conf}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Dec 4 2023 13:54:35 for Open CASCADE Technology by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
